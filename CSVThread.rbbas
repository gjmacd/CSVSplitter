#tag ClassProtected Class CSVThreadInherits Thread	#tag Event		Sub Run()		  Dim nRecord as Integer = 0		  Dim f as FolderItem		  Try		    f=SpecialFolder.Documents.Child("CSVSplitter")		    if not f.Exists then 		      f.CreateAsFolder		    end if		  Catch Err as NilObjectException		    MsgBox "The path is invalid!"		  End Try		  Try		    FileParts  = Val(Window1.cmbParts.Text)		    LinesPerFilePart = Ceil (CSVGlobals.nRecords / FileParts)		    Window1.RowLabel.Text = CStr (LinesPerFilePart) + " lines per file."		    		    Dim Header as String		    Window1.pbSplit.Enabled = False		    CSVRecordSet1.MoveFirst		    for i as integer = 1 to CSVRecordSet1.FieldCount - 1		      Header = Header + CSVRecordSet1.IdxField(i).StringValue		      if i < CSVRecordSet1.FieldCount - 1 then		        Header = Header + ","		      end if		    next i		    		    Window2.ShowModal		    		    CSVRecordSet1.MoveFirst                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       		    if CSVRecordSet1 <> Nil then		      While not CSVRecordSet1.EOF 		        Window1.ProgressBar1.Value =  Window1.ProgressBar1.Value + 1		        Window1.ProgressBar1.Refresh		        Window1.RowLabel.Text = CStr (Window1.ProgressBar1.Value) + " of " + CStr (Window1.ProgressBar1.Maximum)		         		        CSVRecordSet1.MoveNext		      wend		    end if		  catch RuntimeException		    MsgBox (RuntimeException.Message)		  end try		  Window1.pbSplit.Enabled = True		  MsgBox ("Split Completed.")		  		  		  		  		End Sub	#tag EndEvent	#tag Method, Flags = &h1000		Sub Constructor(rs as CSVRecordSet)		  // Calling the overridden superclass constructor.		  Super.Constructor		  CSVRecordSet1 = rs		  		End Sub	#tag EndMethod	#tag Property, Flags = &h0		CSVRecordSet1 As CSVRecordSet	#tag EndProperty	#tag Property, Flags = &h0		FileParts As Integer	#tag EndProperty	#tag Property, Flags = &h0		LinesPerFilePart As Integer	#tag EndProperty	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Priority"			Visible=true			Group="Behavior"			InitialValue="5"			Type="Integer"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="StackSize"			Visible=true			Group="Behavior"			InitialValue="0"			Type="Integer"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Thread"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			Type="Integer"			InheritedFrom="Thread"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass