#tag WindowBegin Window Window1   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   212   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1255823062   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   True   MinWidth        =   64   Placement       =   2   Resizeable      =   False   Title           =   "CSV Splitter"   Visible         =   True   Width           =   551   Begin TextField fldCSVFile      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   88      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   25      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   351   End   Begin PushButton pBrowse      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Browse..."      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   451      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   26      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton pbSplit      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "Split!"      Default         =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   451      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   58      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin CheckBox cbHeaderRow      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Include header in each part"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   88      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      State           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   118      Underline       =   ""      Value           =   False      Visible         =   True      Width           =   229   End   Begin Label Label1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   12      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   5      TabPanelIndex   =   0      Text            =   "CSV File:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   25      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   74   End   Begin Label Label2      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   12      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   6      TabPanelIndex   =   0      Text            =   "Lines:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   55      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   74   End   Begin Label Label3      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   12      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   7      TabPanelIndex   =   0      Text            =   "Parts:"      TextAlign       =   2      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   86      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   74   End   Begin PushButton pbQuit      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "&Quit"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   451      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   87      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin TextField fldLines      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      AutomaticallyCheckSpelling=   False      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      Italic          =   ""      Left            =   88      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   10      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   55      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   80   End   Begin ProgressBar ProgressBar1      AutoDeactivate  =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Maximum         =   100      Scope           =   0      TabPanelIndex   =   0      Top             =   174      Value           =   0      Visible         =   False      Width           =   419   End   Begin Label RowLabel      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   180      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   12      TabPanelIndex   =   0      Text            =   ""      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   87      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   229   End   Begin Label DetectLabel      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   180      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      Selectable      =   False      TabIndex        =   13      TabPanelIndex   =   0      Text            =   ""      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   58      Transparent     =   False      Underline       =   ""      Visible         =   True      Width           =   229   End   Begin ComboBox cmbParts      AutoComplete    =   False      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   False      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialValue    =   "10\r20\r30\r40\r50\r60\r70\r80\r90\r100\r"      Italic          =   ""      Left            =   88      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   14      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   86      Underline       =   ""      UseFocusRing    =   True      Visible         =   True      Width           =   80   End   Begin PushButton pbAbout      AutoDeactivate  =   True      Bold            =   ""      ButtonStyle     =   0      Cancel          =   ""      Caption         =   "About"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   451      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   16      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   118      Underline       =   ""      Visible         =   True      Width           =   80   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Sub Close()		  Quit		  		End Sub	#tag EndEvent	#tag Event		Sub Open()		  		  		End Sub	#tag EndEvent#tag EndWindowCode#tag Events pBrowse	#tag Event		Sub Action()		  dim dlg as openDialog		  dim f as folderitem		  		  //The OpenDialog class will show a standard open dialog		  dlg = new OpenDialog		  dlg.filter=FileTypes1.Csv		  dlg.Title = "Select a CSV file to Split"		  f = dlg.showModal		  		  //if the user clicked cancel, f will equal nil		  //if it's not nil, then we can display its info		  		  if f <> nil then		    // display the information		    		    //f.absolutePath-- Full path to the file as a string		    fldCSVFile.text=f.absolutePath		    		    //f.creationDate-- Creation date as a Date class		    'creationDateText.text=f.creationDate.shortDate		    //f.ModificationDate-- Modification date as a Date class		    'modificationDateText.text=f.modificationDate.shortDate		    		    //f.displayName-- The name that is displayed to the user		    //  Only will be different if the extension is hid (OS X.1+)		    'displayNameText.text=f.displayName		    //f.name-- The full name of the file		    'nameText.text=f.name		    		    //f.length-- The length of the data fork		    //              (length is the size in bytes)		    'lengthText.text=str(f.length)		    //f.resourceForkLength-- The length of the resourceFork		    'resourceForkLengthText.text=str(f.resourceForkLength)		    		    //f.MacCreator-- The four character creator code		    'macCreatorText.text=f.macCreator		    //f.MacType-- The four character type code		    'macTypeText.text=f.macType		    //f.Type-- The type of the file as defined in the file types menu		    'typeText.text=f.type		    		    		    if f is nil then return		    		    CSVRecordSet1 = New CSVRecordSet (f)		    		    		    		    Window1.fldLines.Text = CStr (nRecords)		    		    ProgressBar1.Maximum =  nRecords		    		    CSVThread1 = New CSVThread (CSVRecordSet1)		    		    GetCSVThread1 = New GetCSVThread		    GetCSVThread1.Run		    		  end if		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbSplit	#tag Event		Sub Action()		  Window1.ProgressBar1.Visible = True		  CSVThread1.Run		  		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbQuit	#tag Event		Sub Action()		  Dim d as New MessageDialog                  //declare the MessageDialog object		  Dim b as MessageDialogButton                //for handling the result		  d.icon=MessageDialog.GraphicQuestion         //display warning icon		  d.ActionButton.Caption="Quit"		  d.CancelButton.Visible=True                 //show the Cancel button		  'd.AlternateActionButton.Visible=True        //show the "Don't Save" button		  'd.AlternateActionButton.Caption="Don't Save"		  d.Message="Would you like to exit?"		  'd.Explanation="If you don't save, your changes will be lost. "		  		  b=d.ShowModal                              //display the dialog		  Select Case b                              //determine which button was pressed.		  Case d.ActionButton		    //user pressed Save		    Quit		    'Case d.AlternateActionButton		    //user pressed Don't Save		  Case d.CancelButton		    //user pressed Cancel		    return		  End select		End Sub	#tag EndEvent#tag EndEvents#tag Events cmbParts	#tag Event		Sub Change()		  CSVThread1.FileParts  = Val(Window1.cmbParts.Text)		  CSVThread1.LinesPerFilePart = Ceil (CSVGlobals.nRecords / CSVThread1.FileParts)		  Window1.RowLabel.Text = CStr (CSVThread1.LinesPerFilePart ) + " lines per file."		  		End Sub	#tag EndEvent#tag EndEvents#tag Events pbAbout	#tag Event		Sub Action()		  AboutWindow.Show		  		  		End Sub	#tag EndEvent#tag EndEvents